

# Lab 1
- **Mục tiêu 1:** [http://14.225.255.76](http://14.225.255.76/)
    - **Nhiệm vụ 1:** Lấy bí mật nằm trong database 
    - **Nhiệm vụ 2:** Directories scan. Tìm ra các endpoints ẩn (sử dụng phương pháp find).
    - **Nhiệm vụ 3:** Directories scan. Tìm ra các endpoints ẩn (sử dụng phương pháp discovery).
    - **Nhiệm vụ 4:** Parameters scan. Tìm ra param ẩn.
    - **Nhiệm vụ 5:** Services scan. Khai thác lỗi đối với các services cũ. Đọc /etc/passwd của server bị lỗi

## Solution

Đầu tiên ta Directories scan bằng ffuf :
`ffuf -w fuzz-Bo0om.txt -u http://14.225.255.76/FUZZ -mc 200`
![[Pasted image 20250706113948.png]]
 Ta thấy file robots.txt khả nghi (có thể chứa config cho các directories không được phép hiện khi tìm kiếm tên miền trên google)
![[Pasted image 20250706112417.png]]
=> File `/secret_file_that_only_admin_can_use.php` khả nghi
![[Pasted image 20250706112451.png]]
Lụm ngay flag đầu tiên

Ta cũng thấy có file test.php khả nghi khi fuzzing
![[Pasted image 20250706112607.png]]
Lụm ngay flag thứ 2
Trong nội dung của trang ta thấy dòng  `Message Received: [object Object]`. Rất có thể dev đã debug bằng cách in ra object error ở mã nguồn -> Thử check mã nguồn xem sao

![[Pasted image 20250706112715.png]]
Chuẩn mịa luôn => Lụm ngay flag thứ 3

Tiếp theo, ta sẽ scan parameters. Sử dụng Arjun : 
`arjun -u [Social-platform](http://14.225.255.76/)`
![[Pasted image 20250706114339.png]]

Ta tìm thấy 1 parameter là `debug`
![[Pasted image 20250706114438.png]]
Param này dẫn tới 1 file source code, khả năng đây là nơi để dev debug code
Lụm ngay flag thứ 4
Ở đây, ta thấy dòng đầu tiên nó có include 1 file `/common/common.php` -> thử vào file này xem. Bên cạnh đó, ta thấy dòng thứ 3 cho phép hiện lên source code nếu truyền vào param `debug` => Ta sẽ truy cập `/common/common.php?debug` để xem src.
![[Pasted image 20250706171854.png]]
Lộ ngay file `db.php` khả năng đó là code quản lý database. Tiếp tục truy cập vào `/common/db.php?debug` để xem src
![[Pasted image 20250706172005.png]]
Ta có thể thấy qua source code của file db, website sử dụng MongoDB để quản lý database và được chạy ở port 27017. Để kiểm tra giả thuyết này, ta sử dụng nmap để quét port này
![[Pasted image 20250706172136.png]]
Đúng là như vậy, ta có thể kết luận luôn là web sử dụng MongoDB chạy trên port 27017
Tra ChatGPT, ta có cách kết nối với server mongoDB : 

```
mongosh --host <IP_đích> --port <PORT> -u <USERNAME> 
-p <PASSWORD> --authenticationDatabase <AUTH_DB>
```

Ta thử kết nối mà không cần username, pass hay authen xem
![[Pasted image 20250706174750.png]]
Được luôn ?? :")
![[Pasted image 20250706185140.png]]
Ta có flag thứ 5


# Lab 2

+ Brute force directories `ffuf -w fuzz-Bo0oM.txt -u http://shop.cyberjutsu-lab.tech/FUZZ -fc 403`
![[Pasted image 20250706232536.png]]
Ta nhận thấy có 2 file `.git/HEAD` và `.git/config` có thể đọc
![[Pasted image 20250706233753.png]]
![[Pasted image 20250706233809.png]]
Á à lộ ngay link github hẹ hẹ :>>>>https://github.com/trulimero4953/shop-cute
![[Pasted image 20250706234031.png]]
Lộ ngay pass của tài khoản admin trong file sql
![[Pasted image 20250706234128.png]]

